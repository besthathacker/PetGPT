<!DOCTYPE html>
<html lang="en">
<head>
Â Â <meta charset="UTF-8" />
Â Â <title>PetGPT Ultimate</title>
Â Â <meta name="viewport" content="width=device-width,initial-scale=1" />
Â Â <script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0/dist/transformers.min.js"></script>
Â Â <style>
Â Â Â Â * { box-sizing: border-box; }
Â Â Â Â html, body {
Â Â Â Â Â Â margin:0; padding:0;
Â Â Â Â Â Â background:#1e1e1e; color:#eee;
Â Â Â Â Â Â font-family:Arial,sans-serif;
Â Â Â Â Â Â display:flex; flex-direction:column;
Â Â Â Â Â Â height:100vh;
Â Â Â Â }
Â Â Â Â header, footer {
Â Â Â Â Â Â background:#007acc; color:#fff;
Â Â Â Â Â Â text-align:center; padding:1rem;
Â Â Â Â Â Â flex-shrink:0;
Â Â Â Â }
Â Â Â Â #container {
Â Â Â Â Â Â flex:1;
Â Â Â Â Â Â display:flex; flex-direction:column;
Â Â Â Â Â Â max-width:800px; width:100%;
Â Â Â Â Â Â margin:auto; padding:1rem;
Â Â Â Â }
Â Â Â Â #chat {
Â Â Â Â Â Â flex:1; overflow-y:auto;
Â Â Â Â Â Â margin-bottom:1rem; padding-right:.5rem;
Â Â Â Â }
Â Â Â Â .message {
Â Â Â Â Â Â margin:.5rem 0; padding:.75rem 1rem;
Â Â Â Â Â Â border-radius:8px; background:#333;
Â Â Â Â Â Â max-width:80%; word-wrap:break-word;
Â Â Â Â }
Â Â Â Â .user { align-self:flex-end; background:#444; }
Â Â Â Â .botÂ Â { align-self:flex-start; }
Â Â Â Â #controls {
Â Â Â Â Â Â display:flex; gap:.5rem; margin-bottom:1rem;
Â Â Â Â }
Â Â Â Â input[type="text"] {
Â Â Â Â Â Â flex:1; padding:.75rem;
Â Â Â Â Â Â border:none; border-radius:8px;
Â Â Â Â Â Â background:#222; color:#fff;
Â Â Â Â }
Â Â Â Â button {
Â Â Â Â Â Â padding:.75rem 1rem; border:none;
Â Â Â Â Â Â border-radius:8px; background:#007acc;
Â Â Â Â Â Â color:#fff; cursor:pointer;
Â Â Â Â }
Â Â Â Â button:disabled { opacity:.5; cursor:default; }
Â Â Â Â #adminPanel {
Â Â Â Â Â Â display:none; padding:1rem; background:#333;
Â Â Â Â Â Â border-radius:8px;
Â Â Â Â }
Â Â Â Â #adminPanel label { display:block; margin-top:.5rem; }
Â Â </style>
</head>
<body>
Â Â <header>ğŸ¾ PetGPT Ultimate</header>
Â Â <div id="container">
Â Â Â Â <div id="chat"></div>
Â Â Â Â <div id="controls">
Â Â Â Â Â Â <input type="text" id="userInput" placeholder="Say somethingâ€¦" autocomplete="off" />
Â Â Â Â Â Â <button id="sendBtn">Send</button>
Â Â Â Â Â Â <button id="resetBtn">Reset Memory</button>
Â Â Â Â Â Â <button id="voiceBtn">ğŸ¤ Voice Chat</button>
Â Â Â Â </div>
Â Â Â Â <div id="adminPanel">
Â Â Â Â Â Â <h4>Admin Panel (type â€œcheetoâ€)</h4>
Â Â Â Â Â Â <label>Background Color: <input type="color" id="bgPicker" /></label>
Â Â Â Â </div>
Â Â </div>
Â Â <footer>Â© 2025 PetGPT Ultimate</footer>

Â Â <script>
Â Â Â Â // UI refs
Â Â Â Â const chatÂ Â Â Â Â Â = document.getElementById('chat');
Â Â Â Â const userInput = document.getElementById('userInput');
Â Â Â Â const sendBtnÂ Â Â = document.getElementById('sendBtn');
Â Â Â Â const resetBtnÂ Â = document.getElementById('resetBtn');
Â Â Â Â const voiceBtnÂ Â = document.getElementById('voiceBtn');
Â Â Â Â const adminPanel= document.getElementById('adminPanel');
Â Â Â Â const bgPickerÂ Â = document.getElementById('bgPicker');

Â Â Â Â // Memory
Â Â Â Â let memory = JSON.parse(localStorage.getItem('petgpt-memory')||'{}');

Â Â Â Â // Append helper
Â Â Â Â function append(text, cls='bot') {
Â Â Â Â Â Â const d = document.createElement('div');
Â Â Â Â Â Â d.className = `message ${cls}`;
Â Â Â Â Â Â d.textContent = text;
Â Â Â Â Â Â chat.appendChild(d);
Â Â Â Â Â Â chat.scrollTop = chat.scrollHeight;
Â Â Â Â }

Â Â Â Â // Initialize GPT-2 pipeline
Â Â Â Â let pipe;
Â Â Â Â async function initAI() {
Â Â Â Â Â Â append('Loading GPT-2 AIâ€¦ please wait.');
Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â // Correct Safari-friendly call
Â Â Â Â Â Â Â Â pipe = await transformers.pipeline('text-generation', { model: 'gpt2' });
Â Â Â Â Â Â Â Â append('âœ… GPT-2 loaded! How can I help?');
Â Â Â Â Â Â } catch (err) {
Â Â Â Â Â Â Â Â console.error('GPT-2 load error:', err);
Â Â Â Â Â Â Â Â append('âš ï¸ GPT-2 failed to load. Fallback active.');
Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â // Get reply: memory, admin, AI or fallback
Â Â Â Â async function getReply(text) {
Â Â Â Â Â Â const t = text.toLowerCase().trim();

Â Â Â Â Â Â if (t.startsWith('remember:')) {
Â Â Â Â Â Â Â Â const [k,v] = t.slice(9).split('=').map(s=>s.trim());
Â Â Â Â Â Â Â Â if (k && v) {
Â Â Â Â Â Â Â Â Â Â memory[k] = v;
Â Â Â Â Â Â Â Â Â Â localStorage.setItem('petgpt-memory', JSON.stringify(memory));
Â Â Â Â Â Â Â Â Â Â return `Got it! I'll remember ${k} = ${v}`;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â return 'Use: remember:key=value';
Â Â Â Â Â Â }

Â Â Â Â Â Â for (let k in memory) {
Â Â Â Â Â Â Â Â if (t.includes(k)) return `ğŸ”– You told me ${k} = ${memory[k]}`;
Â Â Â Â Â Â }

Â Â Â Â Â Â if (t.includes('cheeto')) {
Â Â Â Â Â Â Â Â adminPanel.style.display = 'block';
Â Â Â Â Â Â Â Â return 'ğŸ‰ Admin unlocked!';
Â Â Â Â Â Â }

Â Â Â Â Â Â if (pipe) {
Â Â Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â Â Â const out = await pipe(text, { max_new_tokens:50, do_sample:true, temperature:.7, top_p:.9 });
Â Â Â Â Â Â Â Â Â Â let reply = out[0].generated_text.slice(text.length).trim();
Â Â Â Â Â Â Â Â Â Â return reply || 'Hmmâ€¦ not sure.';
Â Â Â Â Â Â Â Â } catch (e) {
Â Â Â Â Â Â Â Â Â Â console.error('Generation error:', e);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â }

Â Â Â Â Â Â // Simple fallback
Â Â Â Â Â Â const fb = { hello:'Hello!', bye:'Goodbye!' };
Â Â Â Â Â Â for (let k in fb) if (t.includes(k)) return fb[k];
Â Â Â Â Â Â return "Sorry, I don't understand.";
Â Â Â Â }

Â Â Â Â // Send message
Â Â Â Â async function sendMessage() {
Â Â Â Â Â Â const txt = userInput.value.trim();
Â Â Â Â Â Â if (!txt) return;
Â Â Â Â Â Â append(`You: ${txt}`, 'user');
Â Â Â Â Â Â userInput.value = '';
Â Â Â Â Â Â sendBtn.disabled = userInput.disabled = true;

Â Â Â Â Â Â try {
Â Â Â Â Â Â Â Â const r = await getReply(txt);
Â Â Â Â Â Â Â Â append(r, 'bot');
Â Â Â Â Â Â } finally {
Â Â Â Â Â Â Â Â sendBtn.disabled = userInput.disabled = false;
Â Â Â Â Â Â Â Â userInput.focus();
Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â sendBtn.onclick = sendMessage;
Â Â Â Â userInput.addEventListener('keydown', e => {
Â Â Â Â Â Â if (e.key==='Enter') { e.preventDefault(); sendMessage(); }
Â Â Â Â });

Â Â Â Â // Reset memory
Â Â Â Â resetBtn.onclick = () => {
Â Â Â Â Â Â if (confirm('Clear memory and chat?')) {
Â Â Â Â Â Â Â Â localStorage.clear(); memory={};
Â Â Â Â Â Â Â Â chat.innerHTML='';
Â Â Â Â Â Â Â Â append('Memory cleared.');
Â Â Â Â Â Â }
Â Â Â Â };

Â Â Â Â // Background color
Â Â Â Â bgPicker.oninput = e => document.body.style.background = e.target.value;

Â Â Â Â // Voice chat
Â Â Â Â if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
Â Â Â Â Â Â const SR = window.SpeechRecognition||window.webkitSpeechRecognition;
Â Â Â Â Â Â const rec = new SR();
Â Â Â Â Â Â let recOn = false;
Â Â Â Â Â Â rec.onstart = () => { recOn=true; voiceBtn.textContent='ğŸ›‘ Stop'; };
Â Â Â Â Â Â rec.onendÂ Â Â = () => { recOn=false; voiceBtn.textContent='ğŸ¤ Voice Chat'; };
Â Â Â Â Â Â rec.onresult= e => { userInput.value=e.results[0][0].transcript; sendMessage(); };
Â Â Â Â Â Â voiceBtn.onclick = () => recOn? rec.stop() : rec.start();
Â Â Â Â } else {
Â Â Â Â Â Â voiceBtn.onclick = () => alert('SpeechRecognition not supported.');
Â Â Â Â }

Â Â Â Â // Kick it off
Â Â Â Â userInput.focus();
Â Â Â Â initAI();
Â Â </script>
</body>
</html>
